(this["webpackJsonpsnake-tron"]=this["webpackJsonpsnake-tron"]||[]).push([[0],{210:function(e,t,n){},316:function(e,t,n){"use strict";n.r(t);var r,a,c=n(0),i=n.n(c),s=n(24),o=n.n(s),l=n(42),u=(n(209),n(210),n(319)),j=n(30),b=n(92),O=n(325),d=n(6),h=O.a.Title,f=O.a.Paragraph,p=function(){return Object(d.jsx)(d.Fragment,{children:"Not implemented..."})},m=b.a.SubMenu,x=O.a.Title,g=u.a.Content,v=u.a.Sider,y=[{title:"Getting started",key:"getting-started",component:p},{title:"Life cylce",key:"life-cycle",component:function(){return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(h,{level:2,children:"Life Cycle"}),Object(d.jsx)(f,{children:"A game takes place over 3 stages. 1. Setup 2. Play 3. Summary"})]})}},{title:"Controllers",key:"controllers",children:[{title:"REST",key:"rest",component:p}]}],S=function e(t){var n=t.contents,r=t.url,a=n.map((function(t){var n=t.children,a=t.title,c=t.key,i=t.icon,s=t.component;return n?Object(d.jsx)(m,{title:a,icon:i,children:Object(d.jsx)(e,{contents:n,url:"".concat(r,"/").concat(c)})},c):s?Object(d.jsx)(b.a.Item,{icon:i,children:Object(d.jsx)(l.b,{to:"".concat(r,"/").concat(c),children:a})},c):null}));return console.groupEnd(),Object(d.jsx)(d.Fragment,{children:a})},k=function(e){var t=[];return function e(n,r){n.forEach((function(n){var a=n.children,c=n.key,i=n.component;a?e(a,"".concat(r,"/").concat(c)):i&&t.push(Object(d.jsx)(j.a,{path:"".concat(r,"/").concat(c),component:i},c))}))}(e.contents,e.url),Object(d.jsx)(d.Fragment,{children:t})},R=function(){var e=Object(j.h)().url,t=Object(d.jsx)(S,{contents:y,url:e}),n=Object(d.jsx)(k,{contents:y,url:e});return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(x,{children:"Docs"}),Object(d.jsxs)(u.a,{children:[Object(d.jsx)(v,{width:200,children:Object(d.jsx)(b.a,{selectable:!1,mode:"inline",style:{height:"100%"},multiple:!1,children:t})}),Object(d.jsx)(g,{className:"content",style:{margin:0,paddingTop:0},children:Object(d.jsx)(j.c,{children:n})})]})]})},T=n(26),C=n(334),E=n(194),N=n(335),I=n(47),w=n(324),A=n(320),M=n(54),P=n(62),D=n(339),U=n(201),G=n(33),_=n.n(G),L=n(27),z=n(59),F=n(77),H=n(331),J=n(151),W=n.n(J),V=n(338),Y={headers:{"Access-Control-Allow-Origin":"*"},timeout:2e3},q=function e(t){var n=this;Object(F.a)(this,e),this.url=void 0,this.init=function(){var e=Object(z.a)(_.a.mark((function e(t){var r,a;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={playerNumber:t.playerNumber},e.next=3,W.a.post(n.url+"/init",t,Object(L.a)(Object(L.a)({},Y),{},{params:r}));case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.update=function(){var e=Object(z.a)(_.a.mark((function e(t,r){var a,c;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={playerNumber:r},e.next=3,W.a.post(n.url+"/update",t,Object(L.a)(Object(L.a)({},Y),{},{params:a}));case 3:return c=e.sent,e.abrupt("return",c.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.end=function(){var e=Object(z.a)(_.a.mark((function e(t,r){var a,c;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={playerNumber:r},e.next=3,W.a.post(n.url+"/end",t,Object(L.a)(Object(L.a)({},Y),{},{params:a}));case 3:return c=e.sent,e.abrupt("return",c.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.url=t},B={Selector:function(e){var t=e.onChange,n=Object(c.useCallback)((function(e){t&&t(e.target.value)}),[t]);return Object(d.jsx)(w.a.Item,{label:"Address",children:Object(d.jsx)(H.a,{prefix:Object(d.jsx)(V.a,{}),onChange:n})})},create:function(e){return new q(e)},label:"REST"},K=function(e){return!!e},X=[B],Q=function(e){var t=e.onControllerChange,n=e.onNext,r=Object(c.useState)([]),a=Object(T.a)(r,2),i=a[0],s=a[1],o=Object(c.useMemo)((function(){return[]}),[]),l=Object(c.useCallback)((function(e){return function(n){o[e]=i[e].factory.create(n),t(o.filter(K))}}),[t,o,i]),u=Object(c.useMemo)((function(){return i.map((function(e,n){var r=e.key,a=e.factory;return Object(d.jsxs)(N.b,{style:{display:"flex"},align:"baseline",children:[Object(d.jsx)(a.Selector,{onChange:l(n)}),Object(d.jsx)(I.a,{type:"text",icon:Object(d.jsx)(D.a,{}),onClick:function(){s(i.filter((function(e){return e.key!==r}))),o[n]=void 0,t(o.filter(K))}})]},r)}))}),[i,s,o,l,t]),j=Object(c.useMemo)((function(){return X.map((function(e,t){return Object(d.jsxs)(I.a,{type:"dashed",icon:Object(d.jsx)(U.a,{}),onClick:function(){s([].concat(Object(E.a)(i),[{key:Object(P.uniqueId)(e.label),factory:e}]))},children:["Add ",e.label," controller"]},t)}))}),[i,s]);return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(w.a,{children:u}),Object(d.jsx)(N.b,{children:j}),Object(d.jsx)(A.a,{}),Object(d.jsx)(M.a,{title:"You must specifiy at least 2 controllers",placement:"right",children:Object(d.jsx)(I.a,{type:"primary",onClick:n,disabled:o.length<2,children:"Next"})})]})},Z=n(144),$=n(202),ee=n(193),te=n(336),ne=n(191),re=n(198),ae=n(333);!function(e){e.DRAW="DRAW",e.WINNER="WINNER",e.TIMEOUT="TIMEOUT"}(r||(r={})),function(e){e.NORTH="N",e.SOUTH="S",e.EAST="E",e.WEST="W",e.NOP="X"}(a||(a={}));var ce,ie=function(e){return Array.isArray(e)&&2===e.length},se=function e(t){var n=this;Object(F.a)(this,e),this.gameState=void 0,this.pool=void 0,this.generatePool=function(){var e=n.gameState,t=e.positions,r=e.meta,a=e.food,c=r.gridSize,i=Object(P.flatten)(t).concat(a);return new Array(c*c).fill(0).map((function(e,t){return[t%c,Math.floor(t/c)]})).filter((function(e){return!i.some((function(t){return Object(P.isEqual)(t,e)}))})).filter(ie)},this.next=function(){var e=Math.floor(Math.random()*n.pool.length);return n.pool.splice(e,1)[0]},this.empty=function(){return 0===n.pool.length},this.gameState=t,this.pool=this.generatePool()},oe=n(70),le=function(e){var t=e[e.length-1],n=t.meta,a=t.playerAlive.filter((function(e){return e})).length,c=a>1?r.TIMEOUT:1===a?r.WINNER:r.DRAW,i=null;c===r.WINNER&&(i=t.playerAlive.findIndex((function(e){return e})));var s=e.map((function(e){return Object(P.omit)(e,["meta"])})),o=(new Date).toISOString();return Object(L.a)(Object(L.a)({},n),{},{tickCount:s.length,ticks:s,winner:i,timeStamp:o,result:c})},ue={gridSize:50,maxTicks:1e3},je=function(){function e(t,n,r){Object(F.a)(this,e),this.controllers=void 0,this.options=void 0,this.gameState=void 0,this.controllersReady=void 0,this.onGameTick=void 0,this.controllers=t,this.options=Object(L.a)(Object(L.a)({},ue),n),this.gameState=this.initState(t,this.options),this.controllersReady=new Array(t.length).fill(!1),this.onGameTick=null!==r&&void 0!==r?r:function(){}}return Object(Z.a)(e,[{key:"initControllers",value:function(){var e=Object(z.a)(_.a.mark((function e(){var t=this;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.controllers.map(function(){var e=Object(z.a)(_.a.mark((function e(n,r){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.init({playerNumber:r,gameId:t.gameState.meta.gameId,gridSize:t.gameState.meta.gridSize,playerCount:t.gameState.meta.playerCount});case 2:t.controllersReady[r]=!0;case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(){var e=Object(z.a)(_.a.mark((function e(){var t,n,r,a=this;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.controllersReady.every((function(e){return e}))){e.next=2;break}throw new Error("Controllers are not ready. "+JSON.stringify(this.controllersReady));case 2:t=[];case 3:if(!(this.gameState.playerAlive.filter((function(e){return e})).length>1&&this.gameState.tick<this.options.maxTicks)){e.next=11;break}return n=Object(P.cloneDeep)(this.gameState),t.push(n),e.next=8,this.update();case 8:this.onGameTick(this.gameState.tick),e.next=3;break;case 11:return r=Object(P.cloneDeep)(this.gameState),t.push(r),this.onGameTick(this.gameState.tick),e.next=16,Promise.all(this.controllers.map(function(){var e=Object(z.a)(_.a.mark((function e(t,n){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.end(a.gameState,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 16:return e.abrupt("return",le(t));case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initState",value:function(e,t){var n=e.length,r={tick:0,positions:[],lastMoves:[],food:[],playerAlive:new Array(n).fill(!0),meta:{playerCount:n,gameId:Object(ae.a)(),gridSize:t.gridSize}},a=new se(r);return r.positions=new Array(n).fill(null).map((function(){return[a.next()]})),r.food=new Array(n).fill(null).map((function(){return a.next()})),r}},{key:"update",value:function(){var e=Object(z.a)(_.a.mark((function e(){var t,n,r=this;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.controllers.map(function(){var e=Object(z.a)(_.a.mark((function e(t,n){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.gameState.playerAlive[n]){e.next=6;break}return e.next=3,t.update(r.gameState,n).catch((function(){return null}));case 3:return e.abrupt("return",e.sent);case 6:return e.abrupt("return",a.NOP);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 2:return t=e.sent,n=this.apply(this.gameState,t),this.gameState=n,e.abrupt("return",this.gameState);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"apply",value:function(e,t){var n=Object(L.a)({},e);n.tick=e.tick+1;var r=t.map((function(t,r){if(t===a.NOP)return n.playerAlive[r]=!1,null;if(null===t)return re.a.error({message:"Player ".concat(r," disqualified"),description:"Player ".concat(r," has been disqualified. Either the controller has crashed or it returned an invalid move."),duration:0}),n.playerAlive[r]=!1,null;if(!e.playerAlive[r])return null;n.lastMoves[r]=t;var c=e.positions[r][0],i=function(e){var t;return(t={},Object(oe.a)(t,a.NORTH,[0,-1]),Object(oe.a)(t,a.SOUTH,[0,1]),Object(oe.a)(t,a.EAST,[1,0]),Object(oe.a)(t,a.WEST,[-1,0]),t)[e]}(t);return[c[0]+i[0],c[1]+i[1]]}));r.forEach((function(e,t){var r,a;null!==e&&(r=e,a=n.meta.gridSize,r.every((function(e){return e>=0&&e<a}))||(n.playerAlive[t]=!1))})),r.forEach((function(e,t){null!==e&&(r.filter((function(t){return null!==t&&t[0]===e[0]&&t[1]===e[1]})).filter(ie).length>1&&(n.playerAlive[t]=!1))}));var c=new Set;r.forEach((function(e,t){if(null!==e){var r=n.food.findIndex((function(t){return null!==t&&t[0]===e[0]&&t[1]===e[1]}));-1!==r?c.add(r):n.positions[t].pop()}}));var i=n.positions.flat();r.forEach((function(e,t){null!==e&&(-1!==i.findIndex((function(t){return null!==t&&t[0]===e[0]&&t[1]===e[1]}))&&(n.playerAlive[t]=!1))})),r.forEach((function(e,t){null!==e&&n.positions[t].unshift(e)}));var s=new se(n);return n.food=n.food.map((function(e,t){if(c.has(t)){if(s.empty())return;return s.next()}return e})).filter(ie),n}}]),e}(),be=O.a.Title;!function(e){e[e.UNSET=0]="UNSET",e[e.CONTROLLER_INIT=1]="CONTROLLER_INIT",e[e.ERROR_STATE=2]="ERROR_STATE",e[e.GAME_RUN=3]="GAME_RUN",e[e.GAME_OVER=4]="GAME_OVER"}(ce||(ce={}));var Oe,de=function(e){Object($.a)(n,e);var t=Object(ee.a)(n);function n(e){var r;return Object(F.a)(this,n),(r=t.call(this,e)).onTickUpdate=function(e){var t=r.props.options;if(t){var n=Math.round(e/t.maxTicks*100);r.setState({tickProgress:n})}},r.onCancel=function(){r.props.onPrev()},r.stateUpdate=function(e){var t=r.state,n=t.runStage,a=t.game;if(a)switch(n){case ce.CONTROLLER_INIT:a.initControllers().then((function(){r.setState({runStage:ce.GAME_RUN})})).catch((function(e){r.setState({runStage:ce.ERROR_STATE,errorTitle:"Error initialising controllers",errorDesc:e.message})}));break;case ce.GAME_RUN:a.run().then((function(e){r.props.gameComplete(e),r.setState({runStage:ce.GAME_OVER,history:e}),r.props.onNext()})).catch((function(e){r.setState({runStage:ce.ERROR_STATE,errorTitle:"Error running game",errorDesc:e.message})}))}else r.setState({runStage:ce.ERROR_STATE,errorTitle:"No game object available"})},r.statusMessage=function(){var e=r.state,t=e.runStage,n=e.errorDesc,a=e.errorTitle;switch(t){case ce.CONTROLLER_INIT:return Object(d.jsx)(be,{level:3,children:"Initialising controllers..."});case ce.ERROR_STATE:return Object(d.jsx)(te.a,{message:a,description:Object(d.jsx)("pre",{children:n}),type:"error",showIcon:!0});case ce.GAME_RUN:return Object(d.jsx)(be,{level:3,children:"Running..."});case ce.GAME_OVER:return Object(d.jsx)(be,{level:3,children:"Game complete!"});default:return Object(d.jsx)(te.a,{message:"Game unset!? Contact dev",type:"warning",showIcon:!0})}},r.state={runStage:ce.UNSET,tickProgress:0},r}return Object(Z.a)(n,[{key:"componentDidUpdate",value:function(e,t){t.runStage!==this.state.runStage&&this.stateUpdate()}},{key:"componentDidMount",value:function(){var e=this.props,t=e.controllers,n=e.options;if(t&&t.length&&n){var r=new je(t,n,this.onTickUpdate);this.setState({game:r,runStage:ce.CONTROLLER_INIT})}else this.setState({runStage:ce.ERROR_STATE,errorTitle:"Missing controllers or options?",errorDesc:JSON.stringify(t,null,2)+"\n"+JSON.stringify(n,null,2)})}},{key:"render",value:function(){var e=this.statusMessage(),t=this.state,n=t.tickProgress,r=t.runStage,a="normal";return r===ce.GAME_RUN?a="active":r===ce.GAME_OVER?a="success":r===ce.ERROR_STATE&&(a="exception"),Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)(N.b,{direction:"vertical",style:{width:"100%",justifyContent:"center",alignItems:"center"},children:[e,Object(d.jsx)(ne.a,{type:"circle",percent:n,status:a}),Object(d.jsx)("br",{}),Object(d.jsx)(I.a,{size:"large",onClick:this.onCancel,danger:!0,children:"Cancel"})]})})}}]),n}(i.a.Component),he=n(328),fe=function(e){var t=e.onConfigChange,n=e.onNext,r=e.onPrev,a=i.a.useState(50),s=Object(T.a)(a,2),o=s[0],l=s[1],u=i.a.useState(1e3),j=Object(T.a)(u,2),b=j[0],O=j[1],h=Object(c.useCallback)((function(){t({gridSize:o,maxTicks:b})}),[t,o,b]),f=Object(c.useCallback)((function(e){O(e),h()}),[h,O]),p=Object(c.useCallback)((function(e){l(e),h()}),[h,l]);return Object(c.useEffect)((function(){t({gridSize:o,maxTicks:b})}),[t,o,b]),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)(w.a,{children:[Object(d.jsx)(w.a.Item,{label:"Max ticks",children:Object(d.jsx)(he.a,{min:1,max:1e4,defaultValue:1e3,value:b,onChange:f})}),Object(d.jsx)(w.a.Item,{label:"Grid size",children:Object(d.jsx)(he.a,{min:10,max:1e3,defaultValue:50,value:o,onChange:p})})]}),Object(d.jsxs)(N.b,{children:[Object(d.jsx)(I.a,{onClick:r,children:"Previous"}),Object(d.jsx)(I.a,{type:"primary",onClick:n,children:"Start"})]})]})},pe=n(330),me=n(332),xe=n(340),ge=n(341),ve=n(342),ye=n(200),Se=n(343),ke=n(344),Re=n(93),Te=n.n(Re);!function(e){e.HISTORIES="histories"}(Oe||(Oe={}));var Ce,Ee=function(){var e=Te.a.get(Oe.HISTORIES)||{};return Object.values(e).sort((function(e,t){return new Date(e.timeStamp).valueOf()-new Date(t.timeStamp).valueOf()}))},Ne=function(e){var t=new Blob([JSON.stringify(e,null,2)],{type:"text/json"});return{href:URL.createObjectURL(t),download:"".concat(e.timeStamp,".json")}},Ie=pe.a.Panel,we=O.a.Paragraph,Ae=function(e){var t=e.gameHistory,n=e.onNext,a=e.onPrev,i=Object(c.useCallback)((function(){t&&function(e){var t=Te.a.get(Oe.HISTORIES)||{};Te.a.set(Oe.HISTORIES,Object(L.a)(Object(L.a)({},t),{},Object(oe.a)({},e.gameId,e)))}(t)}),[t]);if(!t)return Object(d.jsx)("div",{children:"Error: No game history specified"});var s=Ne(t),o=Object(d.jsx)(me.a,{icon:Object(d.jsx)(xe.a,{}),status:"success",title:"Player "+t.winner+" wins!"});return t.result===r.DRAW?o=Object(d.jsx)(me.a,{icon:Object(d.jsx)(ge.a,{}),status:"warning",title:"Draw!"}):t.result===r.TIMEOUT&&(o=Object(d.jsx)(me.a,{icon:Object(d.jsx)(ve.a,{}),status:"warning",title:"Timeout"})),Object(d.jsxs)(d.Fragment,{children:[o,Object(d.jsxs)(N.b,{children:[Object(d.jsx)(I.a,{onClick:a,type:"primary",children:"Play again"}),Object(d.jsx)(I.a,{onClick:n,children:"New game"}),Object(d.jsx)(l.b,{to:"/viewer?gameId=".concat(null===t||void 0===t?void 0:t.gameId),children:Object(d.jsx)(I.a,{icon:Object(d.jsx)(ye.a,{}),children:"Show in viewer"})}),Object(d.jsx)(I.a,{icon:Object(d.jsx)(Se.a,{}),onClick:i,children:"Save to local storage"}),Object(d.jsx)(I.a,Object(L.a)(Object(L.a)({icon:Object(d.jsx)(ke.a,{})},s),{},{children:"Download replay"}))]}),Object(d.jsx)(A.a,{}),Object(d.jsx)(pe.a,{children:Object(d.jsx)(Ie,{header:"Full Game History",children:Object(d.jsx)(we,{children:Object(d.jsx)("pre",{children:JSON.stringify(t,null,2)})})},"1")})]})},Me=C.a.Step,Pe=O.a.Title;!function(e){e[e.CONTROLLER_CREATOR=0]="CONTROLLER_CREATOR",e[e.GAME_SETUP=1]="GAME_SETUP",e[e.PLAYING=2]="PLAYING",e[e.SUMMARY=3]="SUMMARY"}(Ce||(Ce={}));var De=function(){var e=Object(c.useState)(Ce.CONTROLLER_CREATOR),t=Object(T.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)([]),i=Object(T.a)(a,2),s=i[0],o=i[1],l=Object(c.useState)(),u=Object(T.a)(l,2),j=u[0],b=u[1],O=Object(c.useState)(),h=Object(T.a)(O,2),f=h[0],p=h[1],m=Object(c.useCallback)((function(e){o(e)}),[o]),x=Object(c.useCallback)((function(e){b(e)}),[b]),g=Object(c.useCallback)((function(e){p(e)}),[p]),v=Object(c.useCallback)((function(){r((n+1)%(Ce.SUMMARY+1))}),[n,r]),y=Object(c.useCallback)((function(){r((n-1)%(Ce.SUMMARY+1))}),[n,r]);return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(Pe,{children:"Play a Game"}),Object(d.jsxs)(C.a,{current:n,children:[Object(d.jsx)(Me,{title:"Controller Creator"}),Object(d.jsx)(Me,{title:"Game Setup"}),Object(d.jsx)(Me,{title:"Running"}),Object(d.jsx)(Me,{title:"Summary"})]}),Object(d.jsx)("br",{}),n===Ce.CONTROLLER_CREATOR&&Object(d.jsx)(Q,{onControllerChange:m,onNext:v}),n===Ce.GAME_SETUP&&Object(d.jsx)(fe,{onConfigChange:x,onNext:v,onPrev:y}),n===Ce.PLAYING&&Object(d.jsx)(de,{controllers:s,options:j,onPrev:y,onNext:v,gameComplete:g}),n===Ce.SUMMARY&&Object(d.jsx)(Ae,{gameHistory:f,onNext:v,onPrev:y})]})},Ue=O.a.Title,Ge=O.a.Paragraph,_e=function(e){return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(Ue,{children:"Snake Tron - Code Fights!"}),Object(d.jsx)(Ge,{children:"What, you thought there would be content?"})]})},Le=u.a.Content,ze=function(e){return Object(d.jsx)(Le,{className:"content",children:e.children})},Fe=u.a.Footer,He=function(){return Object(d.jsxs)(Fe,{className:"footer",children:["Created by ",Object(d.jsx)("a",{href:"http://samuel-lewis.com/",children:"Samuel Lewis"})]})},Je=u.a.Header,We=function(){return Object(d.jsxs)(Je,{className:"header",children:[Object(d.jsx)("div",{className:"logo"}),Object(d.jsxs)(b.a,{theme:"dark",mode:"horizontal",children:[Object(d.jsx)(b.a.Item,{children:Object(d.jsx)(l.b,{to:"/",children:"Home"})},"home"),Object(d.jsx)(b.a.Item,{children:Object(d.jsx)(l.b,{to:"/game",children:"Game"})},"game"),Object(d.jsx)(b.a.Item,{children:Object(d.jsx)(l.b,{to:"/viewer",children:"Viewer"})},"viewer"),Object(d.jsx)(b.a.Item,{children:Object(d.jsx)(l.b,{to:"/tester",children:"Controller Tester"})},"tester"),Object(d.jsx)(b.a.Item,{children:Object(d.jsx)(l.b,{to:"/docs",children:"Docs"})},"docs")]})]})},Ve=n(326),Ye=n(321),qe=n(322),Be=Ve.a.TabPane,Ke=O.a.Title,Xe=O.a.Paragraph,Qe="48e2ee9e-171e-45bd-8904-a762d8e2b782",Ze={playerNumber:1,playerCount:2,gameId:Qe,gridSize:50},$e={tick:2,positions:[[[42,31],[41,31],[40,31]],[[47,27],[47,28]]],lastMoves:[a.NORTH,a.SOUTH],food:[[35,16],[17,6]],playerAlive:[!0,!0],meta:{playerCount:2,gameId:Qe,gridSize:50}},et=function(){var e=Object(c.useState)(null),t=Object(T.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(""),i=Object(T.a)(a,2),s=i[0],o=i[1],l=Object(c.useState)(""),u=Object(T.a)(l,2),j=u[0],b=u[1],O=Object(c.useCallback)((function(e){r(B.create(e))}),[r]),h=Object(c.useCallback)((function(){b(JSON.stringify(Ze,null,2)),null===n||void 0===n||n.init(Ze).then((function(e){return o(JSON.stringify(e,null,2))})).catch((function(e){return o(e.message)}))}),[n,o]),f=Object(c.useCallback)((function(){b(JSON.stringify($e,null,2)),null===n||void 0===n||n.update($e,1).then((function(e){return o(JSON.stringify(e,null,2))})).catch((function(e){return o(e.message)}))}),[n,o]),p=Object(c.useCallback)((function(){b(JSON.stringify($e,null,2)),null===n||void 0===n||n.end($e,1).then((function(e){return o(JSON.stringify(e,null,2))})).catch((function(e){return o(e.message)}))}),[n,o]);return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(Ke,{children:"Controller Tester"}),Object(d.jsx)(Ve.a,{defaultActiveKey:"1",children:Object(d.jsx)(Be,{tab:B.label,children:Object(d.jsx)(B.Selector,{onChange:O})},"1")}),Object(d.jsxs)(N.b,{children:[Object(d.jsx)(I.a,{onClick:h,children:"Test game initialise"}),Object(d.jsx)(I.a,{onClick:f,children:"Test game update"}),Object(d.jsx)(I.a,{onClick:p,children:"Test game end"})]}),Object(d.jsxs)(Ye.a,{gutter:16,children:[Object(d.jsxs)(qe.a,{span:12,children:[Object(d.jsx)(A.a,{children:"Sent"}),Object(d.jsx)(Xe,{children:j&&Object(d.jsx)("pre",{children:j})})]}),Object(d.jsxs)(qe.a,{span:12,children:[Object(d.jsx)(A.a,{children:"Response"}),Object(d.jsx)(Xe,{children:s&&Object(d.jsx)("pre",{children:s})})]})]})]})},tt=n(199),nt=n(329),rt=n(197),at=n(337),ct=n(323),it=n(327),st=["#e6194B","#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#42d4f4","#f032e6","#bfef45","#fabed4","#469990","#dcbeff","#9A6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075"],ot=function(e){return st[e%st.length]},lt=400,ut=function(e,t){var n=Object(T.a)(e,2);return[n[0]*t+t/2,n[1]*t+t/2]};var jt=function(e){var t=Object(c.useRef)(null),n=e.state,r=e.gridSize;return Object(c.useLayoutEffect)((function(){var e=t.current;if(e){var a=e.getContext("2d");if(a){var c=lt/r;!function(e){e.clearRect(0,0,lt,lt),e.lineWidth=1,e.strokeStyle="white",e.strokeRect(0,0,lt,lt)}(a),n.positions.forEach((function(e,t){!function(e,t,n,r){var a=ot(r),c=ut(n[0],t),i=Object(T.a)(c,2),s=i[0],o=i[1];e.lineWidth=t-2,e.strokeStyle=a,e.lineCap="square",e.beginPath(),e.moveTo(s,o),n.forEach((function(n){var r=ut(n,t),a=Object(T.a)(r,2),c=a[0],i=a[1];e.lineTo(c,i)})),e.stroke()}(a,c,e,t)})),n.food.forEach((function(e){return function(e,t,n){var r=ut(n,t),a=Object(T.a)(r,2),c=a[0],i=a[1];e.fillStyle="green",e.beginPath(),e.arc(c,i,t/2,0,2*Math.PI),e.fill()}(a,c,e)}))}}}),[t,n,r]),Object(d.jsx)("canvas",{width:lt,height:lt,ref:t})},bt=n(107),Ot=n(109),dt=O.a.Paragraph,ht=function(e){var t=e.frame;if(!t)return null;var n=new Array(t.playerAlive.length).fill(null).map((function(e,n){return{key:"Player ".concat(n),alive:t.playerAlive[n],lastMove:t.lastMoves[n],position:t.positions[n],playerNumber:n}})),r=[{title:"Player",dataIndex:"playerNumber",key:"playerNumber",render:function(e){return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("span",{className:"dot",style:{backgroundColor:ot(e)}}),"Player ",e]})}},{title:"Alive",dataIndex:"alive",key:"alive",render:function(e){return e?Object(d.jsx)(bt.a,{}):Object(d.jsx)(Ot.a,{})}},{title:"Last Move",dataIndex:"lastMove",key:"lastMove"},{title:"Positions",dataIndex:"position",key:"position",render:function(e){return JSON.stringify(e)},ellipsis:!0}];return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)(dt,{children:["Tick: ",t.tick]}),Object(d.jsxs)(dt,{children:["Food: ",JSON.stringify(t.food)]}),Object(d.jsx)(ct.a,{size:"small",dataSource:n,columns:r,pagination:!1,expandable:{expandedRowRender:function(e){return Object(d.jsx)("p",{style:{margin:0},children:JSON.stringify(e.position)})}}})]})},ft=function(e){var t=e.history,n=Object(c.useState)(0),r=Object(T.a)(n,2),a=r[0],i=r[1],s=Object(c.useCallback)((function(e){return i(e)}),[i]);return t?Object(d.jsxs)(Ye.a,{justify:"center",children:[Object(d.jsxs)(qe.a,{span:12,children:[Object(d.jsx)(jt,{state:t.ticks[a],gridSize:t.gridSize}),Object(d.jsx)(it.a,{style:{width:"400px",marginLeft:0,marginRight:0},value:a,min:0,max:t.tickCount-1,onChange:s})]}),Object(d.jsx)(qe.a,{span:12,children:Object(d.jsx)(ht,{frame:t.ticks[a]})})]}):Object(d.jsx)("div",{children:"Error: No history loaded?!"})},pt=["key","humanDate"],mt=O.a.Title,xt=O.a.Paragraph,gt=function(e){var t=e.onDelete,n=Object(c.useCallback)((function(){nt.a.warning({title:"Are you sure you want to delete all game replays?",closable:!0,okText:"Delete all",okCancel:!0,okButtonProps:{danger:!0,type:"primary"},content:Object(d.jsx)(xt,{children:"Are you sure you want to delete all game replays? This can not be undone."}),onOk:t})}),[t]);return Object(d.jsx)(I.a,{icon:Object(d.jsx)(D.a,{}),onClick:n,danger:!0,type:"text",children:"Delete all histories"})},vt=function(){var e=Object(j.f)(),t=Object(c.useState)(Ee().reverse()),n=Object(T.a)(t,2),a=n[0],i=n[1],s=Object(c.useState)(),o=Object(T.a)(s,2),u=o[0],b=o[1],O=new URLSearchParams(Object(j.g)().search),h=Object(c.useCallback)((function(){b(void 0),Te.a.set(Oe.HISTORIES,{}),i(Ee()),e.push("/viewer")}),[b,e]);Object(c.useEffect)((function(){var e=O.get("gameId");if(e)if("latest"!==e){var t=a.find((function(t){return t.gameId===e}));t?b(t):rt.b.error("Could not find game ".concat(e))}else b(a[0])}),[a,b,O]);var f=Object(c.useMemo)((function(){return a.map((function(e){return Object(L.a)(Object(L.a)({},e),{},{key:e.gameId})}))}),[a]),p=[{title:"Timestamp",dataIndex:"timeStamp",key:"timeStamp",ellipsis:!0,sorter:{compare:function(e,t){return new Date(e.timeStamp).valueOf()-new Date(t.timeStamp).valueOf()},multiple:1},render:function(e){return Object(d.jsx)("span",{children:new Date(e).toString()})}},{title:"Result",dataIndex:"result",key:"result",sorter:{compare:function(e,t){return e.result.localeCompare(t.result)},multiple:2},render:function(e,t){var n=t.winner,a=e===r.WINNER?"green":e===r.DRAW?"blue":"red";return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(at.a,{color:a,children:e}),-1!==n&&Object(d.jsxs)("span",{children:["Player ",n]})]})}},{title:"Player count",dataIndex:"playerCount",key:"playerCount",sorter:{compare:function(e,t){return e.playerCount-t.playerCount},multiple:4}},{title:"Tick count",dataIndex:"tickCount",key:"tickCount",sorter:{compare:function(e,t){return e.tickCount-t.tickCount},multiple:5}},{title:"Grid size",dataIndex:"gridSize",key:"gridSize",sorter:{compare:function(e,t){return e.gridSize-t.gridSize},multiple:6}},{title:"ID",dataIndex:"gameId",key:"gameId",ellipsis:!0,sorter:{compare:function(e,t){return e.gameId.localeCompare(t.gameId)},multiple:7}},{title:"Actions",key:"actions",render:function(t,n){n.key,n.humanDate;var r=Object(tt.a)(n,pt),a=Ne(r);return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(M.a,{title:"View",children:Object(d.jsx)(l.b,{to:"/viewer?gameId=".concat(r.gameId),children:Object(d.jsx)(I.a,{icon:Object(d.jsx)(ye.a,{})})})}),Object(d.jsx)(M.a,{title:"Download",children:Object(d.jsx)(I.a,Object(L.a)({icon:Object(d.jsx)(ke.a,{})},a))}),Object(d.jsx)(M.a,{title:"Delete",children:Object(d.jsx)(I.a,{onClick:function(){!function(e){var t=Te.a.get(Oe.HISTORIES)||{};t[e]=void 0,Te.a.set(Oe.HISTORIES,t),Ee()}(n.gameId),i(Ee()),u&&u.gameId===n.gameId&&(b(void 0),e.push("/viewer"))},icon:Object(d.jsx)(D.a,{})})})]})}}];return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(mt,{children:"Game Viewer"}),u&&Object(d.jsx)(ft,{history:u}),Object(d.jsx)(A.a,{children:"Saved Rounds"}),Object(d.jsx)(ct.a,{dataSource:f,columns:p,pagination:{pageSize:10,position:["topRight","bottomRight"],showTotal:function(e){return"".concat(e," games")}}}),Object(d.jsx)(gt,{onDelete:h})]})};var yt=function(){return Object(d.jsx)("div",{className:"App",children:Object(d.jsxs)(u.a,{className:"layout",children:[Object(d.jsx)(We,{}),Object(d.jsx)(ze,{children:Object(d.jsxs)(j.c,{children:[Object(d.jsx)(j.a,{exact:!0,path:"/",component:_e}),Object(d.jsx)(j.a,{path:"/game",component:De}),Object(d.jsx)(j.a,{path:"/viewer",component:vt}),Object(d.jsx)(j.a,{path:"/tester",component:et}),Object(d.jsx)(j.a,{path:"/docs",component:R})]})}),Object(d.jsx)(He,{})]})})};o.a.render(Object(d.jsx)(i.a.StrictMode,{children:Object(d.jsx)(l.a,{children:Object(d.jsx)(yt,{})})}),document.getElementById("root"))}},[[316,1,2]]]);
//# sourceMappingURL=main.19d028bb.chunk.js.map