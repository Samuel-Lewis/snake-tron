(this["webpackJsonpsnake-tron"]=this["webpackJsonpsnake-tron"]||[]).push([[0],{166:function(e,t,n){},257:function(e,t,n){"use strict";n.r(t);var r,a=n(0),c=n.n(a),i=n(24),s=n.n(i),o=n(54),l=(n(165),n(166),n(261)),u=n(23),j=n(37),h=n(268),b=n(267),O=n(266),d=n(154),f=n(31),p=n.n(f),x=n(51),m=n(69),g=n(270),v=n(123),C=n.n(v),y=n(275),S=n(6),k={"Access-Control-Allow-Origin":"*"},T=function e(t){var n=this;Object(m.a)(this,e),this.url=void 0,this.init=function(){var e=Object(x.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post(n.url,t,{headers:k});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.update=function(){var e=Object(x.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post(n.url,t,{headers:k});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.url=t},w=function(e){var t=e.setController,n=e.position,r=Object(a.useCallback)((function(e){var n=new T(e.target.value);t(n)}),[t]);return Object(S.jsx)(O.a.Item,{label:"Address",name:n,children:Object(S.jsx)(g.a,{prefix:Object(S.jsx)(y.a,{}),onChange:r})})},R=function(e){return!!e},N=function(e){var t=e.onControllerChange,n=e.onNext,r=Object(a.useMemo)((function(){return[]}),[]),c=Object(a.useCallback)((function(e){return function(n){r[e]=n,t(r.filter(R))}}),[t,r]);return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)(O.a,{children:[Object(S.jsx)(w,{setController:c(0)}),Object(S.jsx)(w,{setController:c(1)})]}),Object(S.jsx)(d.a,{type:"primary",onClick:n,children:"Next"})]})},A=n(108),E=n(159),P=n(155),M=n(273),I=n(156),z=n(64),L=n(109),G=n(271),F=n(65);!function(e){e.NORTH="N",e.SOUTH="S",e.EAST="E",e.WEST="W"}(r||(r={}));var J,U=function(e){return[Math.floor(Math.random()*e),Math.floor(Math.random()*e)]},H=function(e){if(0===e.length)return{error:!0,errorMessage:"No moves made"};var t=e[0].meta,n=e[e.length-1].playerAlive.findIndex((function(e){return e})),r=e.map((function(e){return Object(L.omit)(e,["meta"])}));return Object(z.a)(Object(z.a)({},t),{},{tickCount:r.length,ticks:r,winner:n,error:!1})},_={gridSize:50,maxTicks:1e3},Y=function(){function e(t,n){Object(m.a)(this,e),this.controllers=void 0,this.options=void 0,this.gameState=void 0,this.controllersReady=void 0,this.controllers=t,this.options=Object(z.a)(Object(z.a)({},_),n),this.gameState=this.initState(t,this.options),this.controllersReady=new Array(t.length).fill(!1)}return Object(A.a)(e,[{key:"initControllers",value:function(){var e=Object(x.a)(p.a.mark((function e(){var t=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.controllers.map(function(){var e=Object(x.a)(p.a.mark((function e(n,r){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.init({playerNumber:r,gameId:t.gameState.meta.gameId,gridSize:t.gameState.meta.gridSize,playerCount:t.gameState.meta.playerCount});case 2:t.controllersReady[r]=!0;case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(){var e=Object(x.a)(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.controllersReady.every((function(e){return e}))){e.next=2;break}throw new Error("Controllers are not ready. "+JSON.stringify(this.controllersReady));case 2:t=[];case 3:if(!(this.gameState.playerAlive.filter((function(e){return e})).length>1&&this.gameState.tick<this.options.maxTicks)){e.next=12;break}return e.t0=L.cloneDeep,e.next=7,this.update();case 7:e.t1=e.sent,n=(0,e.t0)(e.t1),t.push(n),e.next=3;break;case 12:return e.abrupt("return",H(t));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initState",value:function(e,t){var n=e.length,r={tick:0,positions:[],lastMoves:[],food:[],playerAlive:new Array(n).fill(!0),meta:{playerCount:n,gameId:Object(G.a)(),gridSize:t.gridSize}};return r.positions=this.uniquePos(r,n).map((function(e){return[e]})),r.food=this.uniquePos(r,n),r}},{key:"uniquePos",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[],r=0;r<t;r++){var a=U(e.meta.gridSize);n.push(a)}return n}},{key:"update",value:function(){var e=Object(x.a)(p.a.mark((function e(){var t,n,r=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.controllers.map(function(){var e=Object(x.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.update(r.gameState);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return t=e.sent,n=this.apply(this.gameState,t),this.gameState=n,e.abrupt("return",this.gameState);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"apply",value:function(e,t){var n,a=Object(z.a)({},e);return a.tick=e.tick+1,t.forEach((function(t,n){var c,i,s=e.positions[n][0],o=function(e){var t;return(t={},Object(F.a)(t,r.NORTH,[0,-1]),Object(F.a)(t,r.SOUTH,[0,1]),Object(F.a)(t,r.EAST,[1,0]),Object(F.a)(t,r.WEST,[-1,0]),t)[e]}(t),l=[s[0]+o[0],s[1]+o[1]];(a.lastMoves[n]=t,c=l,i=a.meta.gridSize,c.every((function(e){return e>=0&&e<i})))?e.positions.some((function(e){return e.some((function(e){var t=Object(j.a)(e,2),n=t[0],r=t[1];return n===l[0]&&r===l[1]}))}))?a.playerAlive[n]=!1:(e.food.some((function(e){return e[0]===l[0]&&e[1]===l[1]&&(a.food=a.food.filter((function(t){return t!==e})),!0)}))||a.positions[n].pop(),a.positions[n].unshift(l)):a.playerAlive[n]=!1})),(n=a.food).push.apply(n,Object(I.a)(this.uniquePos(a,a.meta.playerCount-a.food.length))),a}}]),e}(),W=b.a.Paragraph,q=function(e){Object(E.a)(n,e);var t=Object(P.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this,e)).onCancel=function(){r.props.onPrev()},r.state={controllersReady:!1},r}return Object(A.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.controllers,r=t.options;if(n){var a=new Y(n,r);this.setState({game:a}),a.initControllers().then((function(){e.setState({controllersReady:!0})})).catch((function(t){e.setState({controllerError:t.message})}))}}},{key:"render",value:function(){var e=this.props,t=e.controllers,n=e.options;if(console.log({controllers:t,options:n}),!t||!t.length||!n)return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(M.a,{message:"Something went wrong... There were either no controllers or no options specified",type:"error",showIcon:!0}),Object(S.jsxs)(W,{children:["Controllers:",Object(S.jsx)("pre",{children:JSON.stringify(t,null,2)})]}),Object(S.jsxs)(W,{children:["Options:",Object(S.jsx)("pre",{children:JSON.stringify(n,null,2)})]}),Object(S.jsx)(d.a,{onClick:this.onCancel,children:"Previous"})]});var r=this.state,a=r.game,c=r.controllersReady,i=r.controllerError,s=null;return a?i?s="Controller error! "+i:c||(s="Initializing controllers..."):s="No game...?",Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(W,{children:s}),Object(S.jsx)(d.a,{onClick:this.onCancel,danger:!0,children:"Cancel"})]})}}]),n}(c.a.Component),V=n(269),D=n(274),B=function(e){var t=e.onConfigChange,n=e.onNext,r=e.onPrev,i=c.a.useState(50),s=Object(j.a)(i,2),o=s[0],l=s[1],u=c.a.useState(1e3),h=Object(j.a)(u,2),b=h[0],f=h[1],p=Object(a.useCallback)((function(){t({gridSize:o,maxTicks:b})}),[t,o,b]),x=Object(a.useCallback)((function(e){f(e),p()}),[p,f]),m=Object(a.useCallback)((function(e){l(e),p()}),[p,l]);return Object(a.useEffect)((function(){t({gridSize:o,maxTicks:b})}),[t,o,b]),Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)(O.a,{children:[Object(S.jsx)(O.a.Item,{label:"Max ticks",children:Object(S.jsx)(V.a,{min:100,max:1e4,defaultValue:1e3,value:b,onChange:x})}),Object(S.jsx)(O.a.Item,{label:"Grid size",children:Object(S.jsx)(V.a,{min:10,max:1e3,defaultValue:50,value:o,onChange:m})})]}),Object(S.jsxs)(D.b,{children:[Object(S.jsx)(d.a,{onClick:r,children:"Previous"}),Object(S.jsx)(d.a,{type:"primary",onClick:n,children:"Start"})]})]})},K=h.a.Step,Q=b.a.Title;!function(e){e[e.CONTROLLER_CREATOR=0]="CONTROLLER_CREATOR",e[e.GAME_SETUP=1]="GAME_SETUP",e[e.PLAYING=2]="PLAYING",e[e.SUMMARY=3]="SUMMARY"}(J||(J={}));var X=function(){var e=Object(a.useState)(J.CONTROLLER_CREATOR),t=Object(j.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)([]),i=Object(j.a)(c,2),s=i[0],o=i[1],l=Object(a.useState)(),u=Object(j.a)(l,2),b=u[0],O=u[1],d=Object(a.useCallback)((function(e){o(e)}),[o]),f=Object(a.useCallback)((function(e){O(e)}),[O]),p=Object(a.useCallback)((function(){r(Math.min(n+1,J.SUMMARY))}),[n,r]),x=Object(a.useCallback)((function(){r(Math.max(n-1,J.CONTROLLER_CREATOR))}),[n,r]);return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(Q,{children:"Play a Game"}),Object(S.jsxs)(h.a,{current:n,children:[Object(S.jsx)(K,{title:"Controller Creator"}),Object(S.jsx)(K,{title:"Game Setup"}),Object(S.jsx)(K,{title:"Running"}),Object(S.jsx)(K,{title:"Summary"})]}),Object(S.jsx)("br",{}),n===J.CONTROLLER_CREATOR&&Object(S.jsx)(N,{onControllerChange:d,onNext:p}),n===J.GAME_SETUP&&Object(S.jsx)(B,{onConfigChange:f,onNext:p,onPrev:x}),n===J.PLAYING&&Object(S.jsx)(q,{controllers:s,options:b,onPrev:x})]})},Z=b.a.Title,$=b.a.Paragraph,ee=function(e){return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(Z,{children:"Snake Tron - Code Fights!"}),Object(S.jsx)($,{children:"What, you thought there would be content?"})]})},te=l.a.Content,ne=function(e){return Object(S.jsx)(te,{className:"content",children:e.children})},re=l.a.Footer,ae=function(){return Object(S.jsxs)(re,{className:"footer",children:["Created by ",Object(S.jsx)("a",{href:"http://samuel-lewis.com/",children:"Samuel Lewis"})]})},ce=n(272),ie=l.a.Header,se=function(){return Object(S.jsxs)(ie,{className:"header",children:[Object(S.jsx)("div",{className:"logo",children:"\ud83d\udc0d\ud83c\udfcd\ufe0f"}),Object(S.jsxs)(ce.a,{theme:"dark",mode:"horizontal",children:[Object(S.jsx)(ce.a.Item,{children:Object(S.jsx)(o.b,{to:"/",children:"Home"})},"home"),Object(S.jsx)(ce.a.Item,{children:Object(S.jsx)(o.b,{to:"/game",children:"Game"})},"game"),Object(S.jsx)(ce.a.Item,{children:Object(S.jsx)(o.b,{to:"/viewer",children:"Viewer"})},"viewer"),Object(S.jsx)(ce.a.Item,{children:Object(S.jsx)(o.b,{to:"/tester",children:"Controller Tester"})},"tester")]})]})},oe=n(265),le=n(262),ue=n(263),je=n(264),he=oe.a.TabPane,be=b.a.Title,Oe=b.a.Paragraph,de={playerNumber:2,playerCount:4,gameId:"sample-test",gridSize:50},fe={tick:2,positions:[[[42,31],[41,31],[40,31]],[[47,27],[47,28]]],lastMoves:[r.NORTH,r.SOUTH],food:[[35,16],[17,6]],playerAlive:[!0,!0],meta:{playerCount:2,gameId:"48e2ee9e-171e-45bd-8904-a762d8e2b782",gridSize:50}},pe=function(){var e=Object(a.useState)(null),t=Object(j.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(""),i=Object(j.a)(c,2),s=i[0],o=i[1],l=Object(a.useState)(""),u=Object(j.a)(l,2),h=u[0],b=u[1],O=Object(a.useCallback)((function(e){r(e)}),[r]),f=Object(a.useCallback)((function(){b(JSON.stringify(de,null,2)),null===n||void 0===n||n.init(de).then((function(e){return o(JSON.stringify(e,null,2))})).catch((function(e){return o(e.message)}))}),[n,o]),p=Object(a.useCallback)((function(){b(JSON.stringify(fe,null,2)),null===n||void 0===n||n.update(fe).then((function(e){return o(JSON.stringify(e,null,2))})).catch((function(e){return o(e.message)}))}),[n,o]);return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(be,{children:"Controller Tester"}),Object(S.jsx)(oe.a,{defaultActiveKey:"1",children:Object(S.jsx)(he,{tab:"Rest",children:Object(S.jsx)(w,{setController:O})},"1")}),Object(S.jsx)(d.a,{onClick:f,children:"Test game initialise"}),Object(S.jsx)(d.a,{onClick:p,children:"Test game update"}),Object(S.jsxs)(le.a,{gutter:16,children:[Object(S.jsxs)(ue.a,{span:12,children:[Object(S.jsx)(je.a,{children:"Sent"}),Object(S.jsx)(Oe,{children:h&&Object(S.jsx)("pre",{children:h})})]}),Object(S.jsxs)(ue.a,{span:12,children:[Object(S.jsx)(je.a,{children:"Response"}),Object(S.jsx)(Oe,{children:s&&Object(S.jsx)("pre",{children:s})})]})]})]})},xe=b.a.Title,me=b.a.Paragraph,ge=function(){return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(xe,{children:"Game Viewer"}),Object(S.jsx)(me,{children:"What, you thought there would be content?"})]})};var ve=function(){return Object(S.jsx)("div",{className:"App",children:Object(S.jsxs)(l.a,{className:"layout",children:[Object(S.jsx)(se,{}),Object(S.jsx)(ne,{children:Object(S.jsxs)(u.c,{children:[Object(S.jsx)(u.a,{exact:!0,path:"/",children:Object(S.jsx)(ee,{})}),Object(S.jsx)(u.a,{path:"/game",children:Object(S.jsx)(X,{})}),Object(S.jsx)(u.a,{path:"/viewer",children:Object(S.jsx)(ge,{})}),Object(S.jsx)(u.a,{path:"/tester",children:Object(S.jsx)(pe,{})})]})}),Object(S.jsx)(ae,{})]})})};s.a.render(Object(S.jsx)(c.a.StrictMode,{children:Object(S.jsx)(o.a,{children:Object(S.jsx)(ve,{})})}),document.getElementById("root"))}},[[257,1,2]]]);
//# sourceMappingURL=main.5ba4938b.chunk.js.map