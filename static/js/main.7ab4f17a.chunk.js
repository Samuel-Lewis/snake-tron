(this["webpackJsonpsnake-tron"]=this["webpackJsonpsnake-tron"]||[]).push([[0],{17:function(t,e,n){},18:function(t,e,n){},22:function(t,e,n){"use strict";n.r(e);var i=n(1),r=n.n(i),a=n(9),o=n.n(a),c=(n(17),n(2)),s=(n(18),n(4)),u=n(0),f=400;function l(t,e,n,i){var r=Object(c.a)(n,2),a=r[0],o=r[1];t.fillStyle=i,t.fillRect(a*e,o*e,e,e)}var h,j=function(t){var e=Object(i.useRef)(null),n=t.state;return Object(i.useLayoutEffect)((function(){var t=e.current;if(t){var i=t.getContext("2d");if(i){var r=n.meta.gridSize,a=f/r;!function(t){t.clearRect(0,0,f,f),t.strokeRect(0,0,f,f)}(i),n.positions.forEach((function(t,e){!function(t,e,n,i){n.forEach((function(n){return l(t,e,n,"red")}))}(i,a,t)})),n.food.forEach((function(t){return l(i,a,t,"green")}))}}}),[e,n]),Object(u.jsx)("canvas",Object(s.a)({width:f,height:f,ref:e},t))},d=function(t){var e=t.states,n=Object(i.useState)(0),r=Object(c.a)(n,2),a=r[0],o=r[1],s=Object(i.useCallback)((function(t){o(t.target.value)}),[o]);return e?Object(u.jsxs)("div",{children:[Object(u.jsx)(j,{state:e[a]}),Object(u.jsx)("input",{type:"range",value:a,min:0,max:e.length-1,onChange:s}),Object(u.jsxs)("div",{children:["Tick: ",a]}),Object(u.jsx)("hr",{}),Object(u.jsx)("pre",{children:JSON.stringify(e[a],null,2)})]}):Object(u.jsx)("div",{children:"No states loaded"})},p=n(12),v=n(7),O=n(10),b=n(24),g=n(11),m=n(3);!function(t){t.NORTH="N",t.SOUTH="S",t.EAST="E",t.WEST="W"}(h||(h={}));var S=function(t){return[Math.floor(Math.random()*t),Math.floor(Math.random()*t)]},y={gridSize:50,maxTicks:1e3},k=function(){function t(e,n){Object(v.a)(this,t),this.controllers=void 0,this.options=void 0,this.gameState=void 0,this.controllers=e,this.options=Object(s.a)(Object(s.a)({},y),n),this.gameState=this.initState(e,this.options),this.initControllers(this.gameState)}return Object(O.a)(t,[{key:"run",value:function(){for(var t=[];this.gameState.playerAlive.filter((function(t){return t})).length>1&&this.gameState.tick<this.options.maxTicks;){var e=Object(g.cloneDeep)(this.update());t.push(e)}return t}},{key:"initControllers",value:function(t){}},{key:"initState",value:function(t,e){var n=t.length,i={tick:0,positions:[],food:[],playerAlive:new Array(n).fill(!0),meta:{playerCount:n,gameId:Object(b.a)(),gridSize:e.gridSize}};return i.positions=this.uniquePos(i,n).map((function(t){return[t]})),i.food=this.uniquePos(i,n),i}},{key:"uniquePos",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[],i=0;i<e;i++){var r=S(t.meta.gridSize);n.push(r)}return n}},{key:"update",value:function(){var t=this,e=this.controllers.map((function(e){return e.update(t.gameState)})),n=this.apply(this.gameState,e);return this.gameState=n,this.gameState}},{key:"apply",value:function(t,e){var n,i=Object(s.a)({},t);return i.tick=t.tick+1,e.forEach((function(e,n){var r,a,o=t.positions[n][0],s=function(t){var e;return(e={},Object(m.a)(e,h.NORTH,[0,-1]),Object(m.a)(e,h.SOUTH,[0,1]),Object(m.a)(e,h.EAST,[1,0]),Object(m.a)(e,h.WEST,[-1,0]),e)[t]}(e),u=[o[0]+s[0],o[1]+s[1]];(r=u,a=i.meta.gridSize,r.every((function(t){return t>=0&&t<a})))?t.positions.some((function(t){return t.some((function(t){var e=Object(c.a)(t,2),n=e[0],i=e[1];return n===u[0]&&i===u[1]}))}))?i.playerAlive[n]=!1:(t.food.some((function(t){return t[0]===u[0]&&t[1]===u[1]&&(i.food=i.food.filter((function(e){return e!==t})),!0)}))||i.positions[n].pop(),i.positions[n].unshift(u)):i.playerAlive[n]=!1})),(n=i.food).push.apply(n,Object(p.a)(this.uniquePos(i,i.meta.playerCount-i.food.length))),i}}]),t}(),x=function t(){Object(v.a)(this,t),this.init=function(){},this.update=function(t){return h.NORTH}};var E=function(){var t=Object(i.useState)([]),e=Object(c.a)(t,2),n=e[0],r=e[1];return Object(i.useEffect)((function(){var t=new x,e=new x,n=new k([t,e]);r(n.run())}),[r]),Object(u.jsxs)("div",{className:"App",children:[Object(u.jsx)("h1",{children:"\ud83d\udc0d\ud83c\udfcd\ufe0f"}),n.length>0&&Object(u.jsx)(d,{states:n})]})};o.a.render(Object(u.jsx)(r.a.StrictMode,{children:Object(u.jsx)(E,{})}),document.getElementById("root"))}},[[22,1,2]]]);
//# sourceMappingURL=main.7ab4f17a.chunk.js.map